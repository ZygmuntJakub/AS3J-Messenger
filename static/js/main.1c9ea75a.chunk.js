(this["webpackJsonpas3j-messenger"]=this["webpackJsonpas3j-messenger"]||[]).push([[0],{111:function(e,a,t){e.exports=t(175)},116:function(e,a,t){},175:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(27),l=t.n(c),o=(t(116),t(4)),i=t(33),m=t(8),s=t(190),u=t(44),d=t(28),h=t(210),p=t(188),E=t(211),f=t(207),g=t(206),b=t(209),w=t(11),v=t.n(w),j="http://34.69.28.200";var O=function(){var e=r.a.useState({}),a=Object(o.a)(e,2),t=a[0],c=a[1],l=Object(n.useState)(!1),i=Object(o.a)(l,2),m=i[0],s=i[1],w=Object(n.useState)(!1),O=Object(o.a)(w,2),S=O[0],k=O[1];return r.a.createElement(u.a,{margin:"medium",animation:"fadeIn",pad:"large",align:"center"},r.a.createElement(h.a,{size:"small"},"Sign Up"),r.a.createElement(p.a,{value:t,onChange:function(e){return c(e)},onSubmit:function(){s(!1),k(!1),v.a.post("".concat(j,"/users"),Object(d.a)({},t)).then((function(e){200===e.status?s(!0):k(!0)})).catch((function(e){k(!0)})),c({})}},m&&r.a.createElement(E.a,{color:"green"},"Registration was successful"),S&&r.a.createElement(E.a,{color:"red"},"Error with request"),r.a.createElement(f.a,{name:"username",htmlfor:"username",label:"username"},r.a.createElement(g.a,{id:"username",name:"username"})),r.a.createElement(f.a,{name:"email",htmlfor:"email",label:"email"},r.a.createElement(g.a,{id:"email",name:"email"})),r.a.createElement(f.a,{name:"password",htmlfor:"password",label:"password"},r.a.createElement(g.a,{type:"password",id:"password",name:"password"})),r.a.createElement(u.a,{direction:"row",gap:"medium"},r.a.createElement(b.a,{type:"submit",primary:!0,label:"Submit"}))))},S=Object(n.createContext)();function k(){return Object(n.useContext)(S)}function z(){return Object(n.useContext)(S)}var y=function(){var e=r.a.useState({}),a=Object(o.a)(e,2),t=a[0],c=a[1],l=Object(n.useState)(!1),i=Object(o.a)(l,2),s=i[0],w=i[1],O=Object(n.useState)(!1),S=Object(o.a)(O,2),y=S[0],x=S[1],I=k().setAuthToken,C=z().setUser;return s?r.a.createElement(m.a,{to:"/"}):r.a.createElement(u.a,{margin:"medium",animation:"fadeIn",pad:"large",align:"center",gap:"small"},r.a.createElement(h.a,{size:"small"},"Sign In"),r.a.createElement(p.a,{value:t,onChange:function(e){return c(e)},onSubmit:function(){v.a.post("".concat(j,"/auth/login"),Object(d.a)({},t)).then((function(e){200===e.status?(C(e.data),I(e.headers.authorization),w(!0)):x(!0)})).catch((function(e){x(!0)}))}},y&&r.a.createElement(E.a,{color:"red"},"Error with request"),r.a.createElement(f.a,{name:"email",htmlfor:"email",label:"email"},r.a.createElement(g.a,{id:"email",name:"email"})),r.a.createElement(f.a,{name:"password",htmlfor:"password",label:"password"},r.a.createElement(g.a,{id:"password",name:"password",type:"password"})),r.a.createElement(u.a,{direction:"row",gap:"medium"},r.a.createElement(b.a,{type:"submit",primary:!0,label:"Submit"}))))};var x=function(){return r.a.createElement(s.a,{background:{opacity:!0,position:"bottom",repeat:"no-repeat",size:"cover",image:"url(https://i.ibb.co/fxR0kLt/bgc.jpg)"}},r.a.createElement(u.a,{background:{color:"light-1",opacity:"strong"},margin:{vertical:"5vw"},basis:"large",direction:"row",border:{color:"brand",size:"large"},animation:"fadeIn",pad:"small",width:"xlarge",justify:"center",alignSelf:"center"},r.a.createElement(O,null),r.a.createElement(y,null)))},I=t(199),C=t(214),A=t(201),P=t(200),J=t(202),D=t(203),T=t(204),U=t(205),N=t(35),R=t(194),B=t(195),F=t(196),q=t(197),M=t(198),W=t(191);function L(){var e=JSON.parse(localStorage.getItem("token"));return e||""}var V=t(49),Y=t.n(V),$=t(50),G=t.n($),H=t(213),K=t(215);function Q(){var e=JSON.parse(localStorage.getItem("user"));return e||{}}var X=t(192),Z=t(193),_=function(e){var a=e.chat,t=Object(n.useState)([]),c=Object(o.a)(t,2),l=c[0],i=c[1],m=r.a.useState(""),s=Object(o.a)(m,2),d=s[0],h=s[1],p=k().setAuthToken,f=Object(n.useRef)(null),g=new Y.a("".concat(j,"/ws")),w=G.a.over(g),O=function(){f.current.scrollIntoView({behavior:"smooth"})};Object(n.useEffect)((function(){v.a.get("".concat(j,"/chats/").concat(a),{headers:{Authorization:L()}}).then((function(e){var t;p(e.headers.authorization),i(e.data),t=e.data,w.connect({},(function(e){w.subscribe("/messages/add/".concat(a),(function(e){t.push(JSON.parse(e.body)),i((function(){return Object(N.a)(t)}))}))}))})).catch((function(e){alert(e)})),O()}),[a,p]),Object(n.useEffect)(O,[l]);return r.a.createElement(u.a,{pad:"medium"},r.a.createElement(H.a,{pad:"20px",rows:["80vh","20%"],columns:["100%"],gap:"small",areas:[{name:"messages",start:[0,0],end:[0,0]},{name:"send",start:[0,1],end:[0,1]}]},l&&r.a.createElement(u.a,{margin:{top:"large"},round:!0,overflow:"auto",gridArea:"messages",background:"light-1"},l.map((function(e){return r.a.createElement(r.a.Fragment,null,e.author!==Q().username?r.a.createElement(u.a,{direction:"row",flex:!1,basis:"80px",animation:"fadeIn",margin:"xsmall",round:!0,pad:"small",background:"light-3",align:"center"},r.a.createElement(u.a,{align:"center"},e.avatar?r.a.createElement(C.a,{size:"small",src:"https://storage.cloud.google.com/as3j-messenger/".concat(e.avatar,".png")}):r.a.createElement(C.a,{size:"small",src:"https://innostudio.de/fileuploader/images/default-avatar.png"}),r.a.createElement(E.a,{size:"11px"},e.author),r.a.createElement(E.a,{size:"11px"},e.timestamp.nano?e.timestamp.hour+":"+e.timestamp.minute+":"+e.timestamp.second:new Date(e.timestamp).toDateString())),r.a.createElement(W.a,null),r.a.createElement(u.a,{margin:{horizontal:"small"}},r.a.createElement(E.a,null,e.content))):r.a.createElement(u.a,{direction:"row",justify:"end",flex:!1,basis:"80px",animation:"fadeIn",margin:"xsmall",round:!0,pad:"small",background:"brand",align:"center"},r.a.createElement(u.a,{margin:{horizontal:"small"}},r.a.createElement(E.a,null,e.content)),r.a.createElement(X.a,null),r.a.createElement(u.a,{align:"center"},e.avatar?r.a.createElement(C.a,{size:"small",src:"https://storage.cloud.google.com/as3j-messenger/".concat(e.avatar,".png")}):r.a.createElement(C.a,{size:"small",src:"https://innostudio.de/fileuploader/images/default-avatar.png"}),r.a.createElement(E.a,{size:"11px"},"You"),r.a.createElement(E.a,{size:"11px"},e.timestamp.nano?e.timestamp.hour+":"+e.timestamp.minute+":"+e.timestamp.second:new Date(e.timestamp).toDateString()))))})),r.a.createElement("div",{ref:f})),r.a.createElement(u.a,{round:!0,pad:"small",animation:"fadeIn",margin:"xxsmall",gridArea:"send",background:"light-1"},r.a.createElement(K.a,{resize:!1,fill:!0,placeholder:"type here",value:d,onChange:function(e){return h(e.target.value)}}),r.a.createElement(b.a,{type:"submit",gap:"small",margin:"small",size:"medium",onClick:function(){v.a.post("".concat(j,"/chats/").concat(a,"/messages"),{value:d},{headers:{Authorization:L()}}).catch((function(e){alert(e)})),h("")}},r.a.createElement(Z.a,null),r.a.createElement(E.a,{margin:"small"},"Send")))))};var ee=function(){var e=r.a.useState([]),a=Object(o.a)(e,2),t=a[0],c=a[1],l=r.a.useState(""),i=Object(o.a)(l,2),s=i[0],d=i[1],h=k().setAuthToken,p=Object(m.g)(),f=new Y.a("".concat(j,"/ws")),g=G.a.over(f);return Object(n.useEffect)((function(){v.a.get("".concat(j,"/chats"),{headers:{Authorization:L()}}).then((function(e){c(e.data),h(e.headers.authorization),g.connect({},(function(a){g.subscribe("/chats/add/".concat(Q().uuid),(function(a){var t=e.data;t.unshift(JSON.parse(a.body)),c((function(){return Object(N.a)(t)}))}))}))})).catch((function(e){p.push("/login")}))}),[p,h]),r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,{width:"400px",overflow:"auto",height:"100vh"},r.a.createElement(R.a,null,r.a.createElement(B.a,null,r.a.createElement(F.a,null,r.a.createElement(q.a,null,r.a.createElement(E.a,{color:"brand"},"Chats")))),r.a.createElement(M.a,null,t&&t.map((function(e){return r.a.createElement(F.a,{key:e.name},r.a.createElement(q.a,null,r.a.createElement(b.a,{hoverIndicator:!0,plain:!0,focusIndicator:!1,color:"brand",icon:r.a.createElement(W.a,null),secondary:!0,key:e.name,label:r.a.createElement(u.a,{pad:"medium"},r.a.createElement(E.a,{size:"small"},e.name),r.a.createElement(E.a,{size:"xsmall"},e.lastMessage),r.a.createElement(E.a,{size:"xsmall"},e.timestamp.nano?e.timestamp.hour+":"+e.timestamp.minute+":"+e.timestamp.second:new Date(e.timestamp).toDateString())),onClick:function(){return d(e.chatUuid)},active:s===e.chatUuid})))}))))),r.a.createElement(u.a,{overflow:"hidden",animation:"fadeIn",height:"100vh",width:"100%",background:"brand"},s?r.a.createElement(_,{chat:s}):r.a.createElement(u.a,{fill:!0,align:"center",justify:"center",direction:"row"},r.a.createElement(E.a,{size:"xxlarge"},"Select chat"))))},ae=function(){var e=r.a.useState(!1),a=Object(o.a)(e,2),t=a[0],n=a[1],c=r.a.useState(!1),l=Object(o.a)(c,2),i=l[0],m=l[1],s=r.a.useState({}),w=Object(o.a)(s,2),O=w[0],S=w[1],k=r.a.useState({}),y=Object(o.a)(k,2),x=y[0],I=y[1],C=r.a.useState(!1),A=Object(o.a)(C,2),P=A[0],J=A[1],D=r.a.useState(""),T=Object(o.a)(D,2),U=T[0],N=T[1],R=z().setUser;return r.a.createElement(u.a,{animation:"fadeIn",pad:"medium",fill:!0,direction:"column",align:"center"},i&&r.a.createElement(E.a,{color:"green"},"success"),t&&r.a.createElement(E.a,{color:"red"},"fill data"),r.a.createElement(h.a,{alignSelf:"center",size:"xsmall"},"edit account"),r.a.createElement(u.a,{fill:!0,justify:"around",direction:"row",width:"100%",align:"center"},r.a.createElement(u.a,{align:"center",direction:"column"},r.a.createElement(E.a,null,"upload avatar"),r.a.createElement(u.a,{margin:"medium"},r.a.createElement("input",{type:"file",name:"file",onChange:function(e){var a=new FormData;a.append("file",e.target.files[0]),v.a.post("".concat(j,"/files/avatars"),a,{headers:{Authorization:L()}}).then((function(e){N(e.data.value)})).catch((function(e){alert(e)}))}}))),r.a.createElement(u.a,{direction:"column",align:"center"},r.a.createElement(u.a,{margin:"medium"},r.a.createElement(p.a,{value:O,onChange:function(e){return S(e)},onSubmit:function(e){var a,t=e.value;(a=t).username?v.a.patch("".concat(j,"/users"),Object(d.a)(Object(d.a)({},a),{},{photoID:U}),{headers:{Authorization:L()}}).then((function(e){R(e.data),m(!0),S({})})).catch((function(e){alert(e)})):n(!0)}},r.a.createElement(f.a,{name:"username",htmlfor:"username-input",label:"username"},r.a.createElement(g.a,{id:"username-input",name:"username"})),r.a.createElement(u.a,{direction:"row",gap:"medium"},r.a.createElement(b.a,{type:"submit",primary:!0,label:"Submit"})))))),r.a.createElement(h.a,{alignSelf:"center",size:"xsmall"},"change password"),P&&r.a.createElement(E.a,{color:"red"},"new passwords are not the same"),r.a.createElement(u.a,null,r.a.createElement(p.a,{value:x,onChange:function(e){return I(e)},onSubmit:function(e){var a,t=e.value;(a=t).currentPassword&&a.newPassword&&a.retype?a.newPassword===a.retype?v.a.patch("".concat(j,"/users/password"),Object(d.a)({},a),{headers:{Authorization:L()}}).then((function(e){R(e.data),m(!0),I({})})).catch((function(e){alert(e)})):J(!0):n(!0)}},r.a.createElement(f.a,{name:"currentPassword",htmlfor:"currentPassword-input",label:"current password"},r.a.createElement(g.a,{type:"password",id:"currentPassword-input",name:"currentPassword"})),r.a.createElement(f.a,{name:"newPassword",htmlfor:"newPassword-input",label:"new password"},r.a.createElement(g.a,{type:"password",id:"newPassword-input",name:"newPassword"})),r.a.createElement(f.a,{name:"retype",htmlfor:"retype-input",label:"retype new password"},r.a.createElement(g.a,{type:"password",id:"retype-input",name:"retype"})),r.a.createElement(u.a,{direction:"row",gap:"medium"},r.a.createElement(b.a,{type:"submit",primary:!0,label:"Submit"})))))},te=function(){var e=r.a.useState([]),a=Object(o.a)(e,2),t=a[0],c=a[1],l=r.a.useState([]),i=Object(o.a)(l,2),s=i[0],d=i[1],h=k().setAuthToken,p=Object(m.g)(),f=function(){v.a.get("".concat(j,"/users"),{headers:{Authorization:L()}}).then((function(e){c(e.data),h(e.headers.authorization)})).catch((function(e){alert(e)}))},g=function(){v.a.get("".concat(j,"/blacklists"),{headers:{Authorization:L()}}).then((function(e){d(e.data),h(e.headers.authorization)})).catch((function(e){p.push("/login")}))};return Object(n.useEffect)((function(){f(),g()}),[p,h]),r.a.createElement(u.a,{animation:"fadeIn",direction:"row",pad:"small",justify:"around",fill:!0},r.a.createElement(u.a,{width:"medium"},r.a.createElement(R.a,{height:"100vh"},r.a.createElement(B.a,null,r.a.createElement(F.a,null,r.a.createElement(q.a,null,r.a.createElement(E.a,{color:"brand"},"Users")))),r.a.createElement(M.a,null,t&&t.map((function(e){return r.a.createElement(F.a,{key:e.uuid},r.a.createElement(q.a,null,r.a.createElement(u.a,{justify:"between",direction:"row",plain:!0},r.a.createElement(E.a,{size:"small"},e.username),r.a.createElement(b.a,{size:"small",label:"block",onClick:function(){v.a.post("".concat(j,"/blacklists/").concat(e.uuid),{},{headers:{Authorization:L()}}).then((function(e){c(e.data),f(),g()})).catch((function(e){alert(e)}))}}))))}))))),r.a.createElement(u.a,{width:"medium"},r.a.createElement(R.a,{height:"100vh"},r.a.createElement(B.a,null,r.a.createElement(F.a,null,r.a.createElement(q.a,null,r.a.createElement(E.a,{color:"brand"},"Blacklist")))),r.a.createElement(M.a,null,s&&s.map((function(e){return r.a.createElement(F.a,{key:e.uuid},r.a.createElement(q.a,null,r.a.createElement(u.a,{justify:"between",direction:"row",plain:!0},r.a.createElement(E.a,{size:"small"},e.username),r.a.createElement(b.a,{size:"small",label:"unblock",onClick:function(){v.a.delete("".concat(j,"/blacklists/").concat(e.uuid),{headers:{Authorization:L()}}).then((function(e){c(e.data),f(),g()})).catch((function(e){alert(e)}))}}))))}))))))},ne=t(212),re=function(){var e=r.a.useState([]),a=Object(o.a)(e,2),t=a[0],c=a[1],l=r.a.useState([Q().uuid]),i=Object(o.a)(l,2),s=i[0],d=i[1],p=r.a.useState(""),f=Object(o.a)(p,2),w=f[0],O=f[1],S=r.a.useState(!1),z=Object(o.a)(S,2),y=z[0],x=z[1],I=k().setAuthToken,C=Object(m.g)();Object(n.useEffect)((function(){v.a.get("".concat(j,"/users"),{headers:{Authorization:L()}}).then((function(e){c(e.data),I(e.headers.authorization)})).catch((function(e){alert(e)}))}),[]);return r.a.createElement(u.a,{animation:"fadeIn",direction:"column",width:"100%",align:"center"},r.a.createElement(h.a,{alignSelf:"center",size:"xsmall"},"add new chat"),y&&r.a.createElement(E.a,{color:"red"},"fill data"),r.a.createElement(u.a,{direction:"row"},r.a.createElement(u.a,{margin:"medium"},t&&t.map((function(e){return r.a.createElement(ne.a,{key:e.uuid,checked:s.includes(e.uuid),label:e.username,onChange:function(a){a.target.checked?d([].concat(Object(N.a)(s),[e.uuid])):d([s.splice(s.indexOf(e.uuid),1)])}})}))),r.a.createElement(u.a,{margin:"medium"},r.a.createElement(g.a,{placeholder:"type name",value:w,onChange:function(e){return O(e.target.value)}}))),r.a.createElement(b.a,{label:"create",onClick:function(){""!==w&&0!==s.length?v.a.post("".concat(j,"/chats"),{name:w,usersUuid:s},{headers:{Authorization:L()}}).then((function(e){c(e.data),I(e.headers.authorization),C.push("/messages")})).catch((function(e){alert(e)})):x(!0)}}))};var ce=function(){var e=k().setAuthToken,a=Object(m.g)();return r.a.createElement(u.a,{direction:"row",animation:"fadeIn"},r.a.createElement(I.a,{width:"300px",background:"brand",height:"100vh",header:r.a.createElement(u.a,{direction:"row"},Q().avatarPresent?r.a.createElement(C.a,{src:"https://storage.cloud.google.com/as3j-messenger/".concat(Q().uuid,".png")}):r.a.createElement(C.a,{src:"https://innostudio.de/fileuploader/images/default-avatar.png"}),r.a.createElement(E.a,{margin:"small"},Q().username)),footer:r.a.createElement(b.a,{icon:r.a.createElement(P.a,null),label:"logout",onClick:function(){e()},hoverIndicator:!0})},r.a.createElement(A.a,{gap:"small"},r.a.createElement(b.a,{icon:r.a.createElement(J.a,null),label:"messages",onClick:function(){return a.push("/messages")}}),r.a.createElement(b.a,{icon:r.a.createElement(D.a,null),label:"users",onClick:function(){return a.push("/users")}}),r.a.createElement(b.a,{icon:r.a.createElement(T.a,null),label:"new chat",onClick:function(){return a.push("/new-chat")}}),r.a.createElement(b.a,{icon:r.a.createElement(U.a,null),label:"account",onClick:function(){return a.push("/account")}}))),r.a.createElement(m.d,null,r.a.createElement(m.b,{exact:!0,path:"/messages",component:ee}),r.a.createElement(m.b,{exact:!0,path:"/users",component:te}),r.a.createElement(m.b,{exact:!0,path:"/account",component:ae}),r.a.createElement(m.b,{exact:!0,path:"/new-chat",component:re})))},le=t(208),oe={global:{font:{family:"Roboto",size:"18px",height:"20px"}}};var ie=function(){var e=JSON.parse(localStorage.getItem("token")),a=Object(n.useState)(e),t=Object(o.a)(a,2),c=t[0],l=t[1],s=Object(n.useState)(e),u=Object(o.a)(s,2),d=u[0],h=u[1];return r.a.createElement(S.Provider,{value:{authToken:c,setAuthToken:function(e){e?localStorage.setItem("token",JSON.stringify(e)):localStorage.clear(),l(e)},user:d,setUser:function(e){e?localStorage.setItem("user",JSON.stringify(e)):localStorage.clear(),h(e)}}},r.a.createElement(le.a,{plain:!0,theme:oe},r.a.createElement(i.a,null,r.a.createElement(m.d,null,r.a.createElement(m.b,{exact:!0,path:"/login",component:x}),r.a.createElement(m.b,{path:"/",render:function(){return c?r.a.createElement(ce,null):r.a.createElement(m.a,{to:"/login"})}})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ie,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[111,1,2]]]);
//# sourceMappingURL=main.1c9ea75a.chunk.js.map